<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [koatty\_router](./koatty_router.md) &gt; [withMiddleware](./koatty_router.withmiddleware.md)

## withMiddleware() function

Helper function to create middleware configuration with advanced features

**Signature:**

```typescript
export declare function withMiddleware(middleware: Function, options?: {
    priority?: number;
    enabled?: boolean;
    conditions?: MiddlewareCondition[];
    metadata?: Record<string, any>;
}): MiddlewareDecoratorConfig;
```

## Parameters

<table><thead><tr><th>

Parameter


</th><th>

Type


</th><th>

Description


</th></tr></thead>
<tbody><tr><td>

middleware


</td><td>

Function


</td><td>

The middleware class


</td></tr>
<tr><td>

options


</td><td>

{ priority?: number; enabled?: boolean; conditions?: [MiddlewareCondition](./koatty_router.middlewarecondition.md)<!-- -->\[\]; metadata?: Record&lt;string, any&gt;; }


</td><td>

_(Optional)_ Advanced configuration options


</td></tr>
</tbody></table>

**Returns:**

[MiddlewareDecoratorConfig](./koatty_router.middlewaredecoratorconfig.md)

MiddlewareDecoratorConfig

## Example


```typescript
@GetMapping('/api/users', {
  middleware: [
    withMiddleware(AuthMiddleware, {
      priority: 100,
      conditions: [{ type: 'header', value: 'authorization', operator: 'contains' }]
    }),
    withMiddleware(RateLimitMiddleware, {
      priority: 90,
      metadata: { limit: 100, window: 60000 }
    })
  ]
})
```

